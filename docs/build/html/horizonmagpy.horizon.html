

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Horizon module &mdash; magstim stimulators 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Magstim (Parent class)" href="horizonmagpy.magstim.html" />
    <link rel="prev" title="Design" href="description.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> magstim stimulators
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="description.html">Design</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="horizonmagpy.magstim.html">Magstim (parent class)</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Example code</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">magstim stimulators</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Horizon module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/horizonmagpy.horizon.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="horizon-module">
<span id="linkhorizon"></span><h1>Horizon module<a class="headerlink" href="#horizon-module" title="Permalink to this headline">¶</a></h1>
<p>The horizon module consists of two classes.</p>
<p>The Horizon class inherits from the <a class="reference internal" href="horizonmagpy.magstim.html#linkmagstim"><span class="std std-ref">Magstim class</span></a> , just as the Rapid class and Bitstim class do.
The QuickFireBox class inherits from a class defined in <a class="reference external" href="https://github.com/neuromti/app-arduino">this repository</a> for controlling arduino microcontrollers in order two stimulate with low latency via BNC.</p>
<span class="target" id="module-horizonmagpy.horizon"></span><dl class="py class">
<dt id="horizonmagpy.horizon.Horizon">
<em class="property">class </em><code class="sig-name descname">Horizon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">serialConnection</span></em>, <em class="sig-param"><span class="n">unlockCode</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">voltage</span><span class="o">=</span><span class="default_value">240</span></em>, <em class="sig-param"><span class="n">version</span><span class="o">=</span><span class="default_value">(9, 4, 0)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="horizonmagpy.magstim.html#horizonmagpy.magstim.Magstim" title="horizonmagpy.magstim.Magstim"><code class="xref py py-class docutils literal notranslate"><span class="pre">horizonmagpy.magstim.Magstim</span></code></a></p>
<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.DEFAULT_UNLOCK_CODE">
<code class="sig-name descname">DEFAULT_UNLOCK_CODE</code><em class="property"> = ''</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.DEFAULT_UNLOCK_CODE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.DEFAULT_VIRTUAL_VERSION">
<code class="sig-name descname">DEFAULT_VIRTUAL_VERSION</code><em class="property"> = (9, 4, 0)</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.DEFAULT_VIRTUAL_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.DEFAULT_VOLTAGE">
<code class="sig-name descname">DEFAULT_VOLTAGE</code><em class="property"> = 240</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.DEFAULT_VOLTAGE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.ENFORCE_ENERGY_SAFETY">
<code class="sig-name descname">ENFORCE_ENERGY_SAFETY</code><em class="property"> = True</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.ENFORCE_ENERGY_SAFETY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.JOULES">
<code class="sig-name descname">JOULES</code><em class="property"> = {0: 0.0, 1: 0.0, 2: 0.1, 3: 0.2, 4: 0.4, 5: 0.6, 6: 0.9, 7: 1.2, 8: 1.6, 9: 2.0, 10: 2.5, 11: 3.0, 12: 3.6, 13: 4.3, 14: 4.9, 15: 5.7, 16: 6.4, 17: 7.3, 18: 8.2, 19: 9.1, 20: 10.1, 21: 11.1, 22: 12.2, 23: 13.3, 24: 14.5, 25: 15.7, 26: 17.0, 27: 18.4, 28: 19.7, 29: 21.2, 30: 22.7, 31: 24.2, 32: 25.8, 33: 27.4, 34: 29.1, 35: 30.8, 36: 32.6, 37: 34.5, 38: 36.4, 39: 38.3, 40: 40.3, 41: 42.3, 42: 44.4, 43: 46.6, 44: 48.8, 45: 51.0, 46: 53.3, 47: 55.6, 48: 58.0, 49: 60.5, 50: 63.0, 51: 65.5, 52: 68.1, 53: 70.7, 54: 73.4, 55: 76.2, 56: 79.0, 57: 81.8, 58: 84.7, 59: 87.7, 60: 90.7, 61: 93.7, 62: 96.8, 63: 100.0, 64: 103.2, 65: 106.4, 66: 109.7, 67: 113.0, 68: 116.4, 69: 119.9, 70: 123.4, 71: 126.9, 72: 130.5, 73: 134.2, 74: 137.9, 75: 141.7, 76: 145.5, 77: 149.3, 78: 153.2, 79: 157.2, 80: 161.2, 81: 165.2, 82: 169.3, 83: 173.5, 84: 177.7, 85: 181.9, 86: 186.3, 87: 190.6, 88: 195.0, 89: 199.5, 90: 204.0, 91: 208.5, 92: 213.1, 93: 217.8, 94: 222.5, 95: 227.3, 96: 232.1, 97: 236.9, 98: 241.9, 99: 246.8, 100: 252.0}</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.JOULES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.MAX_FREQUENCY">
<code class="sig-name descname">MAX_FREQUENCY</code><em class="property"> = {240: {0: {0: 60, 1: 60, 2: 60, 3: 60, 4: 60, 5: 60, 6: 60, 7: 60, 8: 60, 9: 60, 10: 60, 11: 60, 12: 60, 13: 60, 14: 60, 15: 60, 16: 60, 17: 60, 18: 60, 19: 60, 20: 60, 21: 60, 22: 60, 23: 60, 24: 60, 25: 60, 26: 60, 27: 60, 28: 60, 29: 60, 30: 60, 31: 60, 32: 60, 33: 60, 34: 59, 35: 57, 36: 56, 37: 54, 38: 53, 39: 51, 40: 50, 41: 49, 42: 48, 43: 47, 44: 45, 45: 44, 46: 43, 47: 43, 48: 42, 49: 41, 50: 40, 51: 39, 52: 38, 53: 38, 54: 37, 55: 36, 56: 36, 57: 35, 58: 34, 59: 34, 60: 33, 61: 33, 62: 32, 63: 32, 64: 31, 65: 31, 66: 30, 67: 30, 68: 29, 69: 29, 70: 29, 71: 28, 72: 28, 73: 27, 74: 27, 75: 27, 76: 26, 77: 26, 78: 26, 79: 25, 80: 25, 81: 25, 82: 24, 83: 24, 84: 24, 85: 24, 86: 23, 87: 23, 88: 23, 89: 22, 90: 22, 91: 22, 92: 22, 93: 22, 94: 21, 95: 21, 96: 21, 97: 21, 98: 20, 99: 20, 100: 20}}}</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.MAX_FREQUENCY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.config_data">
<code class="sig-name descname">config_data</code><em class="property"> = {'defaultRapidType': 0, 'defaultVoltage': 240, 'enforceEnergySafety': True, 'unlockCode': '', 'virtualUnlockCode': '1234-12345678-Ã½\x91', 'virtualVersionNumber': '(9,4,0)'}</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.config_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.connect">
<code class="sig-name descname">connect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the Horizon.</p>
<p>This starts the serial port controller,
as well as a process that constantly keeps in contact with the Horizon so as not to lose control.
It also collects the software version number of the Horizon
in order to send the correct command for obtaining parameter settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and the automated response from the Horizon unit.
The default is False.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>MagstimError</strong> – Either if no remote control could be established or if the Version couldn´t be determined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.disconnect">
<code class="sig-name descname">disconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.disconnect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnect from the Magstim.</p>
<p>This stops maintaining contact with the Magstim and turns the serial port controller off.</p>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.fire">
<code class="sig-name descname">fire</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.fire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.fire" title="Permalink to this definition">¶</a></dt>
<dd><p>Fire the stimulator.</p>
<p>This checks whether rTMS mode is active,
and if so whether the sequence has been validated
and the min wait time between trains has elapsed.</p>
<p>N.B. Will only succeed if previously armed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Magstim instrument status [‘instr’]
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getErrorCode">
<code class="sig-name descname">getErrorCode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getErrorCode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getErrorCode" title="Permalink to this definition">¶</a></dt>
<dd><p>Get current error code from Horizon.</p>
<p>See the Operating Manual for how to interpret these error codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>tuple int</em> – Error code (0 = no error; 1+ = error).</p></li>
<li><p><em>tuple dict,str</em> – If error is 0 (False) returns a dict containing Horizon instrument status [‘instr’]
and current error code [‘errorCode’] dicts, otherwise returns an error string</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getMaxContinuousOperationFrequency">
<code class="sig-name descname">getMaxContinuousOperationFrequency</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getMaxContinuousOperationFrequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getMaxContinuousOperationFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Maximal continuous operation frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>power</strong> (<em>int</em>) – Current power in settings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Maximum continuous operation frequency
that will allow for continuous operation (up to 6000 pulses).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getMaxOnTime">
<code class="sig-name descname">getMaxOnTime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frequency</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getMaxOnTime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getMaxOnTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate maximum train duration per minute for given power and frequency.</p>
<p>To ensure that the System must not be made to dissipate more than 63000 Joules per minute.
If greater than 60 seconds, will allow for continuous operation for up to 6000 pulses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>power</strong> (<em>int</em>) – Current power in settings.</p></li>
<li><p><strong>frequency</strong> (<em>int</em>) – stimulation frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Maximum On Time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getMinWaitTime">
<code class="sig-name descname">getMinWaitTime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nPulses</span></em>, <em class="sig-param"><span class="n">frequency</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getMinWaitTime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getMinWaitTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate minimum wait time between trains.</p>
<p>N.B. The absolute minimum wait time ist 0.5 seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>power</strong> (<em>int</em>) – Current power in settings.</p></li>
<li><p><strong>nPulses</strong> (<em>int</em>) – Number of pulses per train.</p></li>
<li><p><strong>frequency</strong> (<em>int</em>) – Stimulation frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The minimum wait time between trains for given power, frequency, and number of pulses.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getParameters">
<code class="sig-name descname">getParameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getParameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Request current parameter settings from the Horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no eRapidrror; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’],
rMTS setting [‘rapid’], and parameter setting [‘rapidParam’] dicts
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getSystemStatus">
<code class="sig-name descname">getSystemStatus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getSystemStatus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getSystemStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>Get system status from the Horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’],rMTS setting [‘rapid’]
and extended instrument status [‘extInstr’] dicts,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.getVersion">
<code class="sig-name descname">getVersion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.getVersion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.getVersion" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Magstim software version number.</p>
<p>This is needed when obtaining parameters from the Magstim.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>tuple int</em> – Error code (0 = no error; 1+ = error).</p></li>
<li><p><em>tuple ?</em> – If error is 0 (False) returns a tuple containing the version number (in (Major,Minor,Patch) format),
otherwise returns an error string</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.ignoreCoilSafetySwitch">
<code class="sig-name descname">ignoreCoilSafetySwitch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.ignoreCoilSafetySwitch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.ignoreCoilSafetySwitch" title="Permalink to this definition">¶</a></dt>
<dd><p>Allow the stimulator to ignore the state of coil safety interlock switch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’] dict,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.quickFire">
<code class="sig-name descname">quickFire</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">duration</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.quickFire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.quickFire" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger the stimulator to fire with very low latency.</p>
<p>N.B. The signal will be sent via the QuickFire-Box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>duration</strong> (<em>int</em>) – Trigger duration in microseconds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.rTMSMode">
<code class="sig-name descname">rTMSMode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">enable</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.rTMSMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.rTMSMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to enable/disable rTMS mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable</strong> (<em>boolean</em>) – Whether to enable (True) or disable (False) control.</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’]
and rMTS setting [‘rapid’] dicts,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receipt argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.remoteControl">
<code class="sig-name descname">remoteControl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">enable</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.remoteControl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.remoteControl" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable/Disable remote control of stimulator.</p>
<p>Disabling remote control will first disarm the Magstim unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable</strong> (<em>boolean</em>) – Whether to enable (True) or disable (False) control.</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’] dict,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.setDuration">
<code class="sig-name descname">setDuration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">newDuration</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.setDuration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.setDuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Set duration of rTMS pulse train.</p>
<p>N.B. Changing the Duration parameter will automatically update the NPulses parameter
based on the current Frequency parameter setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newDuration</strong> (<em>int/float</em>) – The duration of each ‘train’(set) of pulses can be set from 0.1s (seconds) up
to a maximum of 600s - in 0.1s increments up to 30s and in 1.0s increments thereafter.</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’] and rMTS setting [‘rapid’] dicts,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.setFrequency">
<code class="sig-name descname">setFrequency</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">newFrequency</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.setFrequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.setFrequency" title="Permalink to this definition">¶</a></dt>
<dd><p>Set frequency of rTMS pulse train.</p>
<p>Changing the Frequency will automatically update the NPulses parameter
based on the current Duration parameter setting.
The maximum frequency allowed depends on the current power level
and the regional power settings (i.e., 115V vs. 240V)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newFrequency</strong> (<em>int/float</em>) – Stimulation Frequency of pulse train in Hz
(0-100 for 240V systems, 0-60 for 115V systems);
decimal values are allowed for frequencies up to 30Hz</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’] and rMTS setting [‘rapid’] dicts,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.setNPulses">
<code class="sig-name descname">setNPulses</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">newNPulses</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.setNPulses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.setNPulses" title="Permalink to this definition">¶</a></dt>
<dd><p>Set number of pulses in rTMS pulse train.</p>
<p>N.B. Changing the NPulses parameter will automatically update the Duration parameter.
(this cannot exceed 10 s) based on the current Frequency parameter setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newNPulses</strong> (<em>int</em>) – New number of pulses in each train can be set beween 1 and 6000 in steps of 1.</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Horizon instrument status [‘instr’] and rMTS setting [‘rapid’] dicts,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.setPower">
<code class="sig-name descname">setPower</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">newPower</span></em>, <em class="sig-param"><span class="n">receipt</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">delay</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.setPower"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.setPower" title="Permalink to this definition">¶</a></dt>
<dd><p>Set power level for the .</p>
<p>N.B. Allow 100 ms per unit drop in power, or 10 ms per unit increase in power.
Changing the power level can result in automatic updating of the Frequency parameter
(if in rTMS mode)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newPower</strong> (<em>int</em>) – New power level (0-100; or 0-110 if enhanced-power mode is enabled)</p></li>
<li><p><strong>receipt</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Whether to return occurrence of an error and
the automated response from the Horizon unit.
The default is False.</p></li>
<li><p><strong>delay</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Enforce delay to allow Horizon time to change Power.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><em>Tuple</em> –</p>
<dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns a dict
containing Magstim instrument status [‘instr’]
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</li>
<li><p><em>None</em> – If receipt argument is False</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.system_info">
<code class="sig-name descname">system_info</code><em class="property"> = {'joules': {0: 0.0, 1: 0.0, 2: 0.1, 3: 0.2, 4: 0.4, 5: 0.6, 6: 0.9, 7: 1.2, 8: 1.6, 9: 2.0, 10: 2.5, 11: 3.0, 12: 3.6, 13: 4.3, 14: 4.9, 15: 5.7, 16: 6.4, 17: 7.3, 18: 8.2, 19: 9.1, 20: 10.1, 21: 11.1, 22: 12.2, 23: 13.3, 24: 14.5, 25: 15.7, 26: 17.0, 27: 18.4, 28: 19.7, 29: 21.2, 30: 22.7, 31: 24.2, 32: 25.8, 33: 27.4, 34: 29.1, 35: 30.8, 36: 32.6, 37: 34.5, 38: 36.4, 39: 38.3, 40: 40.3, 41: 42.3, 42: 44.4, 43: 46.6, 44: 48.8, 45: 51.0, 46: 53.3, 47: 55.6, 48: 58.0, 49: 60.5, 50: 63.0, 51: 65.5, 52: 68.1, 53: 70.7, 54: 73.4, 55: 76.2, 56: 79.0, 57: 81.8, 58: 84.7, 59: 87.7, 60: 90.7, 61: 93.7, 62: 96.8, 63: 100.0, 64: 103.2, 65: 106.4, 66: 109.7, 67: 113.0, 68: 116.4, 69: 119.9, 70: 123.4, 71: 126.9, 72: 130.5, 73: 134.2, 74: 137.9, 75: 141.7, 76: 145.5, 77: 149.3, 78: 153.2, 79: 157.2, 80: 161.2, 81: 165.2, 82: 169.3, 83: 173.5, 84: 177.7, 85: 181.9, 86: 186.3, 87: 190.6, 88: 195.0, 89: 199.5, 90: 204.0, 91: 208.5, 92: 213.1, 93: 217.8, 94: 222.5, 95: 227.3, 96: 232.1, 97: 236.9, 98: 241.9, 99: 246.8, 100: 252.0}, 'maxFrequency': {240: {0: {0: 60, 1: 60, 2: 60, 3: 60, 4: 60, 5: 60, 6: 60, 7: 60, 8: 60, 9: 60, 10: 60, 11: 60, 12: 60, 13: 60, 14: 60, 15: 60, 16: 60, 17: 60, 18: 60, 19: 60, 20: 60, 21: 60, 22: 60, 23: 60, 24: 60, 25: 60, 26: 60, 27: 60, 28: 60, 29: 60, 30: 60, 31: 60, 32: 60, 33: 60, 34: 59, 35: 57, 36: 56, 37: 54, 38: 53, 39: 51, 40: 50, 41: 49, 42: 48, 43: 47, 44: 45, 45: 44, 46: 43, 47: 43, 48: 42, 49: 41, 50: 40, 51: 39, 52: 38, 53: 38, 54: 37, 55: 36, 56: 36, 57: 35, 58: 34, 59: 34, 60: 33, 61: 33, 62: 32, 63: 32, 64: 31, 65: 31, 66: 30, 67: 30, 68: 29, 69: 29, 70: 29, 71: 28, 72: 28, 73: 27, 74: 27, 75: 27, 76: 26, 77: 26, 78: 26, 79: 25, 80: 25, 81: 25, 82: 24, 83: 24, 84: 24, 85: 24, 86: 23, 87: 23, 88: 23, 89: 22, 90: 22, 91: 22, 92: 22, 93: 22, 94: 21, 95: 21, 96: 21, 97: 21, 98: 20, 99: 20, 100: 20}}}}</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.system_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="horizonmagpy.horizon.Horizon.validateSequence">
<code class="sig-name descname">validateSequence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#Horizon.validateSequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.Horizon.validateSequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate the energy consumption for the current rTMS parameters for the Horizon.</p>
<p>This must be performed before running any new sequence,
otherwise calling fire() will return an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>error: int</dt><dd><p>error code (0 = no error; 1+ = error)</p>
</dd>
<dt>message: dict,str</dt><dd><p>if error is 0 (False) returns current parameters,
otherwise returns an error string</p>
</dd>
</dl>
<p>If receiptType argument is True.</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="horizonmagpy.horizon.Horizon.yaml_file">
<code class="sig-name descname">yaml_file</code><em class="property"> = &lt;_io.TextIOWrapper name='C:\\Users\\roboTMS\\Desktop\\Magstim\\horizonmagpy\\horizonmagpy\\horizon_system_info.yaml' mode='r' encoding='cp1252'&gt;</em><a class="headerlink" href="#horizonmagpy.horizon.Horizon.yaml_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="horizonmagpy.horizon.QuickFireBox">
<em class="property">class </em><code class="sig-name descname">QuickFireBox</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">baud</span><span class="o">=</span><span class="default_value">115200</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">version</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#QuickFireBox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.QuickFireBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">horizonmagpy.base.Base</span></code></p>
<p>For Triggering with low latency a second box is used.</p>
<dl class="py method">
<dt id="horizonmagpy.horizon.QuickFireBox.trigger">
<code class="sig-name descname">trigger</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">duration_in_us</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/horizonmagpy/horizon.html#QuickFireBox.trigger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#horizonmagpy.horizon.QuickFireBox.trigger" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger the BNC default for 1ms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>duration_in_us</strong> (<em>int</em>) – trigger duration in microseconds</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="horizonmagpy.magstim.html" class="btn btn-neutral float-right" title="Magstim (Parent class)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="description.html" class="btn btn-neutral float-left" title="Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ricarda Staehle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>